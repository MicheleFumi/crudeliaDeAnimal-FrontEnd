<div class="container">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center my-3">
    <h1 class="text-center">I tuoi animali</h1>
    <a class="btn btn-primary btn-sm" href="#" role="button">
      Aggiungi animale
    </a>
  </div>

  <!-- Lista animali -->
  <div class="row">
    <div class="col-12" *ngFor="let animale of animali">
      <div class="card mb-3 shadow-sm p-3 d-flex flex-row align-items-center">
        <!-- Icona -->
        <div class="me-3 fs-3 text-primary">
          <i
            class="fa-solid"
            [ngClass]="{
              'fa-dog': animale.tipo === 'cane',
              'fa-cat': animale.tipo === 'gatto',
              'fa-dove': animale.tipo === 'uccello',
              'fa-dragon': animale.tipo === 'rettile',
              'fa-paw': animale.tipo === 'roditore'
            }"
          ></i>
        </div>

        <!-- Info -->
        <div class="flex-grow-1">
          <h5 class="mb-1">{{ animale.nomeAnimale }}</h5>
          <p class="mb-1 text-muted">
            <strong>Razza:</strong> {{ animale.razza }}
          </p>
          <p class="mb-0">
            <strong>Note Mediche:</strong> {{ animale.noteMediche }}
          </p>
        </div>

        <!-- Azioni -->
        <div class="ms-3 text-nowrap">
          <button
            type="button"
            class="btn btn-warning btn-sm"
            data-bs-toggle="modal"
            [attr.data-bs-target]="'#updateModal'"
          >
            Modifica
          </button>
          <button
            class="btn btn-danger btn-sm"
            data-bs-toggle="modal"
            [attr.data-bs-target]="'#deleteModal' + animale.id"
          >
            Elimina
          </button>
        </div>
      </div>

      <!-- Modal Modifica -->
      <div class="modal fade" [id]="'updateModal'" tabindex="-1">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Modifica {{ animale.nomeAnimale }}</h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
              ></button>
            </div>
            <form [formGroup]="updateForm" (ngSubmit)="OnUpdate()">
              <div class="modal-body">
                <input type="hidden" formControlName="utente" />

                <div class="mb-3">
                  <label class="form-label">Nome</label>
                  <input
                    type="text"
                    formControlName="nomeAnimale"
                    class="form-control"
                  />
                </div>

                <div class="mb-3">
                  <label class="form-label">Tipo</label>
                  <select formControlName="tipo" class="form-select">
                    <option *ngFor="let t of tipi" [ngValue]="t">
                      {{ t }}
                    </option>
                  </select>
                </div>

                <div class="mb-3">
                  <label class="form-label">Razza</label>
                  <input
                    type="text"
                    formControlName="razza"
                    class="form-control"
                  />
                </div>

                <div class="mb-3">
                  <label class="form-label">Note Mediche</label>
                  <textarea
                    formControlName="noteMediche"
                    class="form-control"
                  ></textarea>
                </div>
              </div>

              <div class="modal-footer">
                <button class="btn btn-secondary" data-bs-dismiss="modal">
                  Chiudi
                </button>
                <button class="btn btn-primary" type="submit">Salva</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Modal Elimina -->
      <div class="modal fade" [id]="'deleteModal' + animale.id" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Elimina {{ animale.nomeAnimale }}</h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
              ></button>
            </div>
            <div class="modal-body">
              Sei sicuro di voler eliminare
              <strong>{{ animale.nomeAnimale }}</strong
              >?
            </div>
            <div class="modal-footer">
              <button class="btn btn-secondary" data-bs-dismiss="modal">
                Annulla
              </button>
              <button class="btn btn-danger" (click)="elimina(animale)">
                Elimina
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
